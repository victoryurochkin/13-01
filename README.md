# Домашнее задание к занятию "`Уязвимости и атаки на информационные системы`" - `Юрочкин В.А.`

---

### Задание 1

Скачайте и установите виртуальную машину Metasploitable: https://sourceforge.net/projects/metasploitable/.

Это типовая ОС для экспериментов в области информационной безопасности, с которой следует начать при анализе уязвимостей.

Просканируйте эту виртуальную машину, используя nmap.

Попробуйте найти уязвимости, которым подвержена эта виртуальная машина.

Сами уязвимости можно поискать на сайте https://www.exploit-db.com/.

Для этого нужно в поиске ввести название сетевой службы, обнаруженной на атакуемой машине, и выбрать подходящие по версии уязвимости.

Ответьте на следующие вопросы:

Какие сетевые службы в ней разрешены?
Какие уязвимости были вами обнаружены? (список со ссылками: достаточно трёх уязвимостей)
Приведите ответ в свободной форме.

`Ответ:`

Сканирование с помощью nmap:

Для сканирования использовалась следующая команда:

```
nmap -sV -p- 192.168.56.101
```
Описание параметров:

-sV — определение версий сетевых служб

-p- — сканирование всех портов



В результате сканирования были обнаружены следующие открытые порты и сетевые сервисы:

| Порт | Служба      | Версия             |
|------|-------------|--------------------|
| 21   | FTP         | vsftpd 2.3.4       |
| 22   | SSH         | OpenSSH 4.7        |
| 23   | Telnet      | telnetd            |
| 25   | SMTP        | Postfix            |
| 53   | DNS         | BIND 9.4.2         |
| 80   | HTTP        | Apache 2.2.8       |
| 139  | SMB         | Samba 3.0.20       |
| 445  | SMB         | Samba 3.0.20       |
| 3306 | MySQL       | MySQL 5.0.51a      |
| 5432 | PostgreSQL  | PostgreSQL         |
| 5900 | VNC         | VNC server         |
| 6667 | IRC         | UnrealIRCd 3.2.8.1 |
| 8009 | AJP         | Apache JServ       |
| 8180 | HTTP        | Apache Tomcat      |

Наличие большого количества открытых сервисов говорит о низком уровне защищённости системы.


Поиск и анализ уязвимостей

После определения версий сервисов был выполнен поиск известных уязвимостей на сайте Exploit-DB:
https://www.exploit-db.com/

Поиск производился по названию сервиса и его версии.


Найденные уязвимости:
1. vsftpd 2.3.4 — Backdoor

Данная версия FTP-сервера содержит встроенную backdoor-уязвимость, которая позволяет получить удалённый доступ к системе без аутентификации.

Ссылка на описание уязвимости:
https://www.exploit-db.com/exploits/17492

2. UnrealIRCd 3.2.8.1 — Backdoor Command Execution

В данной версии IRC-сервера присутствует уязвимость, позволяющая выполнять произвольные команды на сервере удалённо.

Ссылка на описание уязвимости:
https://www.exploit-db.com/exploits/9540

3. Apache Tomcat AJP — Ghostcat (CVE-2020-1938)

Уязвимость протокола AJP позволяет злоумышленнику читать файлы сервера и получать доступ к конфиденциальной информации.

Ссылка на описание уязвимости:
https://www.exploit-db.com/exploits/46611

---

###Задание 2
Проведите сканирование Metasploitable в режимах SYN, FIN, Xmas, UDP.

Запишите сеансы сканирования в Wireshark.

Ответьте на следующие вопросы:

Чем отличаются эти режимы сканирования с точки зрения сетевого трафика?
Как отвечает сервер?
Приведите ответ в свободной форме.

`Ответ:`

Используемые режимы сканирования

Для выполнения задания были использованы следующие команды:

### SYN scan
```
nmap -sS 192.168.56.101
```

FIN scan

```
nmap -sF 192.168.56.101
```

Xmas scan

```
nmap -sX 192.168.56.101
```


UDP scan

```
nmap -sU 192.168.56.101
```

Отличия режимов сканирования с точки зрения сетевого трафика
SYN scan (TCP SYN Scan)

Отправляется TCP-пакет с установленным флагом SYN

Полное TCP-соединение не устанавливается

Используется «полуоткрытое» соединение

Трафик в Wireshark:

Клиент → сервер: SYN

Сервер → клиент:

SYN, ACK — если порт открыт

RST — если порт закрыт

---

FIN scan (TCP FIN Scan)

Отправляется TCP-пакет с флагом FIN

Используется нестандартный способ определения состояния порта

Часто применяется для обхода простых firewall’ов

Трафик в Wireshark:

Клиент → сервер: FIN

Сервер → клиент:

Нет ответа — если порт открыт

RST — если порт закрыт

---

Xmas scan (TCP Xmas Scan)

Отправляется TCP-пакет с флагами FIN, PSH, URG

Пакет называется «Xmas», так как «зажигает» сразу несколько флагов

Также используется для обхода фильтрации

Трафик в Wireshark:

Клиент → сервер: FIN, PSH, URG

Сервер → клиент:

Нет ответа — если порт открыт

RST — если порт закрыт

---

UDP scan (UDP Scan)

Используются UDP-пакеты

UDP — протокол без установления соединения

Самый медленный и неточный тип сканирования

Трафик в Wireshark:

Клиент → сервер: UDP

Сервер → клиент:

ICMP Port Unreachable — если порт закрыт

Нет ответа — если порт открыт или фильтруется

---

Как отвечает сервер Metasploitable

В ходе анализа сетевого трафика в Wireshark было установлено, что виртуальная машина Metasploitable отвечает на различные типы сканирования стандартным образом, без каких-либо механизмов защиты или фильтрации.

| Режим сканирования | Ответ сервера при открытом порте | Ответ сервера при закрытом порте |
|-------------------|----------------------------------|----------------------------------|
| SYN               | SYN/ACK                          | RST                              |
| FIN               | Нет ответа                       | RST                              |
| Xmas              | Нет ответа                       | RST                              |
| UDP               | Нет ответа                       | ICMP Port Unreachable            |

При **SYN-сканировании** сервер отвечает пакетом `SYN/ACK`, что явно указывает на открытый порт.  
При **FIN** и **Xmas-сканировании** открытые порты игнорируют входящие пакеты, а закрытые отвечают `RST`, что соответствует стандартному поведению TCP-стека.  
При **UDP-сканировании** сервер возвращает ICMP-сообщение `Port Unreachable` для закрытых портов, а для открытых портов чаще всего не отвечает вовсе.

Такое поведение говорит о том, что Metasploitable не использует firewall или IDS/IPS и специально оставлена максимально уязвимой.






